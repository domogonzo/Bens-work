// Copyright Â© Rockwell Automation Technologies, Inc. All Rights Reserved
function isEmptyObject(e){for(var r in e)return!1;return!0}function sort_descending_by_weight(e){return e.concat().sort(function(e,r){return r.weight-e.weight})}function sort_pages_ascending_by_keyword_rank(e,r){var o=r.toLocaleLowerCase();return e.concat().sort(function(e,r){if(0==e.hasOwnProperty("keywords")||0==r.hasOwnProperty("keywords"))return 0;var t=null,a=null;for(var n in e.keywords)if(o==n.toLocaleLowerCase()){t=e.keywords[n];break}for(var _ in r.keywords)if(o==_.toLocaleLowerCase()){a=r.keywords[_];break}return null==t&&null==a?0:null!==t&&null==a?-1:null==t&&null!==a?1:isNaN(t)&&isNaN(a)?0:!isNaN(t)&&isNaN(a)?-1:isNaN(t)&&!isNaN(a)?1:t-a})}function truncate_right_side_at_whole_word_near_char(e,r){if(e>r.length||e<0)return r;var t=r.substring(0,e),a=r[e+1],n=t.lastIndexOf(" ");return" "!==a&&(t=t.substring(0,n)),t}function truncate_left_side_at_whole_word_near_char(e,r){if(e>r.length||e<0)return r;var t=r.substring(e),a=r[e-1],n=t.indexOf(" ")+1;return" "!==a&&(t=t.substring(n)),t}function page_preview_text(e,r){var t=300;for(var a in r){var n=r[a],_=new RegExp(n,"gi"),o=e.text.length,s=e.text.search(_);if(-1!=s){if(s<=t-n.length){var i=e.text.slice(0,t);return t<o&&(i=truncate_right_side_at_whole_word_near_char(i.length,i),i+="..."),i}return i=o-t<=s?"..."+(i=truncate_left_side_at_whole_word_near_char(0,i=e.text.slice(-t))):"..."+(i=truncate_left_side_at_whole_word_near_char(0,i=truncate_right_side_at_whole_word_near_char((i=e.text.slice(s-150,s+n.length+150)).length,i)))+"..."}}i=e.text.slice(0,t);return t<o&&(i+="..."),i}function getParameterByName(e,r){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(r);return null==t?"":decodeURIComponent(t[1].replace(/\+/g," "))}function split_search_term_into_fragments(e){var r=[e];return r=r.concat(e.split(" ")),dedup_array=string_array_dedup_caseinsensitive(r),dedup_array}function remove_one_or_fewer_character_search_terms(e){var r=[];for(var t in e){var a=e[t];1<a.length&&r.push(a)}return r}function remove_disallowed_english_search_terms(e){var r=[],t=["the","a","an","and","nor","but","or","yet","so","as"];for(var a in e){var n=e[a],_=!1;for(var o in t){n==t[o]&&(_=!0)}0==_&&r.push(n)}return r}function string_array_dedup_caseinsensitive(e){var r=[];for(var t in e){var a=e[t],n=!1;for(var _ in r){var o=r[_];if(a.toLocaleLowerCase()==o.toLocaleLowerCase()){n=!0;break}}0==n&&r.push(a)}return r}function page_has_keyword(e,r){if(!e.keywords)return!1;for(var t in e.keywords)if(r.toLocaleLowerCase()==t.toLocaleLowerCase())return!0;return!1}function page_has_text(e,r){var t=new RegExp(r,"gi");return null!=e.title.match(t)||null!=e.text.match(t)}function page_is_ait_duplicate(e){var r=new RegExp("_[0-9]{1,}.htm$","gi");return null!=e.url.match(r)}function page_weight(e,r){for(var t=0,a=0;a<r.length;a++){var n=new RegExp(r[a],"gi"),_=e.title.match(n),o=e.text.match(n);null!=_&&(t+=50*_.length),null!=o&&(t+=o.length)}return t}function two_page_keywords_match(e,r){if(0==e.hasOwnProperty("keywords")&&0==r.hasOwnProperty("keywords"))return!0;if(1==e.hasOwnProperty("keywords")&&1==r.hasOwnProperty("keywords")){for(var t in e.keywords)if(e.keywords[t]!=r.keywords[t])return!1;for(var t in r.keywords)if(r.keywords[t]!=e.keywords[t])return!1;return!0}return!1}function two_pages_match(e,r){return!(e.id!=r.id||e.title!=r.title||e.url!=r.url||e.text!=r.text||!two_page_keywords_match(e,r))}function remove_duplicate_entries(e){for(var r=[],t=0;t<e.length;t++){var a=e[t],n=!1;for(var _ in r){if(two_pages_match(a,r[_])){n=!0;break}}0==n&&r.push(a)}return r}function remove_text_matches_that_have_keyword_matches(e,r){for(var t=[],a=0;a<e.length;a++){var n=e[a],_=!1;for(var o in r)for(var s in kw_page_array=r[o],kw_page_array)if(two_pages_match(kw_page_array[s],n)){_=!0;break}0==_&&t.push(n)}return t}function page_to_html(e,r,t){var a="",n=encodeURI(e.url+"?highlight="+r);a=(a=(a=(a=(a=(a=a.concat("<div>")).concat('<p><h2 class="search_result_title">')).concat('<a href="'+n+'">')).concat(e.title)).concat("</a>")).concat("</h2></p>");var _=page_preview_text(e,t);return a=(a=(a=(a=a.concat('<p class="search_result_text">')).concat(_)).concat("</p>")).concat("</div>")}function build_keyword_match_obj(e,r){for(var t={},a=0;a<e.length;a++)for(var n=0;n<r.length;n++)if(!page_is_ait_duplicate(r[n])){var _=r[n],o=e[a].toLocaleLowerCase();page_has_keyword(_,o)&&(void 0===t[o]&&(t[o]=[]),t[o].push(_))}return t}function build_full_text_match_array(e,r){for(var t=[],a=0;a<e.length;a++)for(var n=0;n<r.length;n++)page_is_ait_duplicate(r[n])||page_has_text(r[n],e[a])&&t.push(r[n]);return t}function results_no_term(){var e="<p>"+translation_please_enter_a_search_term+"</p>";return $("#search_results").append(e)}function results_no_matches_for_term(e){var r="<p>"+translation_no_results_for_term+' "<span class="search_term"></span>".';$("#search_results").append(r),$("span.search_term").text(e)}function results_matches_for_term(e,r,t,a){var n="";for(var _ in t)for(var o=t[_],s=0;s<o.length;s++)n=n.concat(page_to_html(o[s],e,r));for(var i=0;i<a.length;i++)n=n.concat(page_to_html(a[i],e,r));return $("#search_results").append(n)}$(document).ready(function(){var e=getParameterByName("search_term",location.href),r=search_db_content();document.title=translation_search_results;var t="<h1>"+translation_search_results+"</h1>";if($("#search_results").append(t),""==e)results_no_term();else{var a=split_search_term_into_fragments(e),n=build_keyword_match_obj(a=remove_disallowed_english_search_terms(a=remove_one_or_fewer_character_search_terms(a)),r),_=build_full_text_match_array(a,r);for(var o in n)n[o]=sort_pages_ascending_by_keyword_rank(n[o],o);for(var s=0;s<_.length;s++)_[s].weight=page_weight(_[s],a);for(var o in _=sort_descending_by_weight(_),n)n[o]=remove_duplicate_entries(n[o]);_=remove_text_matches_that_have_keyword_matches(_=remove_duplicate_entries(_),n),isEmptyObject(n)&&0==_.length?results_no_matches_for_term(e):results_matches_for_term(e,a,n,_)}});